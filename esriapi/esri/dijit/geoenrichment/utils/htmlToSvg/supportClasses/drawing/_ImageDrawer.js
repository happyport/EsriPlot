// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://js.arcgis.com/3.30/esri/copyright.txt for details.
//>>built
define("esri/dijit/geoenrichment/utils/htmlToSvg/supportClasses/drawing/_ImageDrawer",["esri/dijit/geoenrichment/when","../ElementBuilder","esri/dijit/geoenrichment/utils/ImageInfoUtil","esri/dijit/geoenrichment/utils/FitUtil"],function(l,v,t,w){var n={drawBackgroundImage:function(e,a){if(e.style.getBackground().image&&-1!==e.style.getBackground().image.indexOf("url")){var m=e.style.getBackground().image.replace("url(","").replace(")","").replace(/"/g,"");return n._drawImage(m,e,a,!1)}},drawImage:function(e,
a,m){return n._drawImage(e.src,a,m,!0)},_preProcessImage:function(e,a,m){if(m||"cover"===a.style.getBackground().size)return null;if("auto"===a.style.getBackground().size)return l(t.getImageInfo(e),function(a){return{w:a.width,h:a.height}}).otherwise(function(){return null});var g=a.style.getBackground().sizePx;return a.style.getBackground().repeatX||a.style.getBackground().repeatY?l(t.getImageInfo(e),function(b){return w.fitBox({w:b.width,h:b.height},{w:g||a.style.cw,h:g||a.style.ch})}).otherwise(function(){return null}):
null},_drawImage:function(e,a,m,g){return l(this._preProcessImage(e,a,g),function(b){function g(b,c){return v.buildElement("image",{"xlink:href":e,x:a.box.x+a.style.getBorder().l.width+b,y:a.box.y+a.style.getBorder().t.width+c,width:p,height:q,opacity:a.style.opacity,clipParams:m,preserveAspectRatio:t,transform:a.style.transform})}var f=b&&b.w||a.style.getBackground().sizePx,h=b&&b.h||f,k=a.style.getBackground().positionXPx,c=a.style.getBackground().positionYPx,r=-1!==a.style.getBackground().positionX.indexOf("%"),
u=-1!==a.style.getBackground().positionY.indexOf("%"),l=a.style.getBackground().repeatX,n=a.style.getBackground().repeatY,d=b=0;f&&(b=r?(a.style.cw-f)*k/100:k,d=u?(a.style.ch-h)*c/100:c);var t;t=f||"contain"===a.style.getBackground().size?void 0:(r?0===k?"xMin":100===k?"xMax":"xMid":"xMid")+(u?0===c?"YMin":100===c?"YMax":"YMid":"YMid")+" slice";var p=f||a.style.cw,q=h||a.style.ch;if(0>=p||0>=q)return null;if(l||n){f=[];if(0>=b)h=b;else for(h=b;0<h;)h-=p;c=h;for(k=0;c<a.style.cw;)c+=p,k++;if(0>=d)c=
d;else for(c=d;0<c;)c-=q;u=c;for(r=0;u<a.style.ch;)u+=q,r++;if(l&&!n)for(b=0;b<k;b++)f.push(g(h+b*p,d));else if(!l&&n)for(d=0;d<r;d++)f.push(g(b,c+d*q));else for(b=0;b<k;b++)for(d=0;d<r;d++)f.push(g(h+b*p,c+d*q));return f}return[g(b,d)]})}};return n});